<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="API documentation for the Rust `SymBorApi` trait in crate `dlopen`."><meta name="keywords" content="rust, rustlang, rust-lang, SymBorApi"><title>dlopen::symbor::SymBorApi - Rust</title><link rel="stylesheet" type="text/css" href="../../normalize.css"><link rel="stylesheet" type="text/css" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../../ayu.css" disabled ><script id="default-settings"></script><script src="../../storage.js"></script><noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="icon" type="image/svg+xml" href="../../favicon.svg">
<link rel="alternate icon" type="image/png" href="../../favicon-16x16.png">
<link rel="alternate icon" type="image/png" href="../../favicon-32x32.png"><style type="text/css">#crate-search{background-image:url("../../down-arrow.svg");}</style></head><body class="rustdoc trait"><!--[if lte IE 8]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu">&#9776;</div><a href='../../dlopen/index.html'><div class='logo-container rust-logo'><img src='../../rust-logo.png' alt='logo'></div></a><p class="location">Trait SymBorApi</p><div class="sidebar-elems"><div class="block items"><a class="sidebar-title" href="#required-methods">Required Methods</a><div class="sidebar-links"><a href="#tymethod.load">load</a></div><a class="sidebar-title" href="#implementors">Implementors</a></div><p class="location"><a href="../index.html">dlopen</a>::<wbr><a href="index.html">symbor</a></p><script>window.sidebarCurrent = {name: "SymBorApi", ty: "trait", relpath: ""};</script><script defer src="sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu"><img src="../../brush.svg" width="18" alt="Pick another theme!"></button><div id="theme-choices" role="menu"></div></div><script src="../../theme.js"></script><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><span class="help-button">?</span>
                <a id="settings-menu" href="../../settings.html"><img src="../../wheel.svg" width="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../../src/dlopen/symbor/api.rs.html#69-74" title="goto source code">[src]</a></span><span class="in-band">Trait <a href="../index.html">dlopen</a>::<wbr><a href="index.html">symbor</a>::<wbr><a class="trait" href="">SymBorApi</a></span></h1><div class="docblock type-decl hidden-by-usual-hider"><pre class="rust trait">pub trait SymBorApi&lt;'a&gt; <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;Self: <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,&nbsp;</span>{
    unsafe fn <a href="#tymethod.load" class="fnname">load</a>(lib: &amp;'a <a class="struct" href="../../dlopen/symbor/struct.Library.html" title="struct dlopen::symbor::Library">Library</a>) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;Self, <a class="enum" href="../../dlopen/enum.Error.html" title="enum dlopen::Error">Error</a>&gt;;
}</pre></div><div class="docblock"><p>Trait for automatic loading of symbols from library.</p>
<p>This trait is intended to be used together with the <code>derive</code> macro.
To use it you need to define a structure, create several fields that
implement the <code>FromRawResult</code> trait and then simply use the automatically
generated <code>load(&amp;Library)</code> function to load all symbols from previously opened library.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered">
<span class="attribute">#[<span class="ident">macro_use</span>]</span>
<span class="kw">extern</span> <span class="kw">crate</span> <span class="ident">dlopen_derive</span>;
<span class="kw">extern</span> <span class="kw">crate</span> <span class="ident">dlopen</span>;
<span class="kw">extern</span> <span class="kw">crate</span> <span class="ident">libc</span>;
<span class="kw">use</span> <span class="ident">dlopen</span>::<span class="ident">symbor</span>::{<span class="ident">Library</span>, <span class="ident">Symbol</span>, <span class="ident">SymBorApi</span>, <span class="ident">PtrOrNull</span>, <span class="ident">RefMut</span>, <span class="ident">PtrOrNullMut</span>};
<span class="kw">use</span> <span class="ident">libc</span>::{<span class="ident">c_double</span>, <span class="ident">c_char</span>};

<span class="attribute">#[<span class="ident">derive</span>(<span class="ident">SymBorApi</span>)]</span>
<span class="kw">struct</span> <span class="ident">Example</span><span class="op">&lt;</span><span class="lifetime">&#39;a</span><span class="op">&gt;</span> {
    <span class="kw">pub</span> <span class="ident">simple_fun</span>: <span class="ident">Symbol</span><span class="op">&lt;</span><span class="lifetime">&#39;a</span>, <span class="kw">unsafe</span> <span class="kw">extern</span> <span class="string">&quot;C&quot;</span> <span class="kw">fn</span>()<span class="op">&gt;</span>,
    <span class="kw">pub</span> <span class="ident">complex_fun</span>: <span class="ident">Symbol</span><span class="op">&lt;</span><span class="lifetime">&#39;a</span>, <span class="kw">unsafe</span> <span class="kw">extern</span> <span class="string">&quot;C&quot;</span> <span class="kw">fn</span>(<span class="ident">c_double</span>)<span class="op">-</span><span class="op">&gt;</span><span class="ident">c_double</span><span class="op">&gt;</span>,
    <span class="kw">pub</span> <span class="ident">optional_fun</span>: <span class="prelude-ty">Option</span><span class="op">&lt;</span><span class="ident">Symbol</span><span class="op">&lt;</span><span class="lifetime">&#39;a</span>, <span class="kw">unsafe</span> <span class="kw">extern</span> <span class="string">&quot;C&quot;</span> <span class="kw">fn</span>()<span class="op">&gt;</span><span class="op">&gt;</span>,
    <span class="kw">pub</span> <span class="ident">nullable_ptr</span>: <span class="ident">PtrOrNullMut</span><span class="op">&lt;</span><span class="lifetime">&#39;a</span>, <span class="ident">c_char</span><span class="op">&gt;</span>,
    <span class="kw">pub</span> <span class="ident">mut_ref_i32</span>: <span class="ident">Symbol</span><span class="op">&lt;</span><span class="lifetime">&#39;a</span>, <span class="kw-2">&amp;</span><span class="lifetime">&#39;a</span> <span class="kw-2">mut</span> <span class="ident">i32</span><span class="op">&gt;</span>,
    <span class="attribute">#[<span class="ident">dlopen_name</span><span class="op">=</span><span class="string">&quot;mut_ref_i32&quot;</span>]</span>
    <span class="kw">pub</span> <span class="ident">the_same_mut_ref_i32</span>: <span class="ident">RefMut</span><span class="op">&lt;</span><span class="lifetime">&#39;a</span>, <span class="ident">i32</span><span class="op">&gt;</span>,
    <span class="kw">pub</span> <span class="ident">not_nullable_ptr</span>: <span class="ident">Symbol</span><span class="op">&lt;</span><span class="lifetime">&#39;a</span>, <span class="op">*</span> <span class="kw-2">mut</span> <span class="ident">c_double</span><span class="op">&gt;</span>
}

<span class="kw">fn</span> <span class="ident">main</span>(){
    <span class="kw">let</span> <span class="ident">lib</span> <span class="op">=</span> <span class="ident">Library</span>::<span class="ident">open</span>(<span class="string">&quot;example.dll&quot;</span>).<span class="ident">expect</span>(<span class="string">&quot;Could not open library&quot;</span>);
    <span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">api</span> <span class="op">=</span> <span class="kw">unsafe</span>{<span class="ident">Example</span>::<span class="ident">load</span>(<span class="kw-2">&amp;</span><span class="ident">lib</span>)}.<span class="ident">expect</span>(<span class="string">&quot;Could not load symbols&quot;</span>);
    <span class="kw">unsafe</span>{(<span class="ident">api</span>.<span class="ident">simple_fun</span>)()};
    <span class="kw">let</span> <span class="kw">_</span> <span class="op">=</span> <span class="kw">unsafe</span>{(<span class="ident">api</span>.<span class="ident">complex_fun</span>)(<span class="number">1.0</span>)};
    <span class="kw">match</span> <span class="ident">api</span>.<span class="ident">optional_fun</span> {
        <span class="prelude-val">Some</span>(<span class="ident">fun</span>) <span class="op">=</span><span class="op">&gt;</span> <span class="kw">unsafe</span> {<span class="ident">fun</span>()},
        <span class="prelude-val">None</span> <span class="op">=</span><span class="op">&gt;</span> <span class="macro">println</span><span class="macro">!</span>(<span class="string">&quot;Optional function could not be loaded&quot;</span>),
    };
    <span class="kw">if</span> <span class="ident">api</span>.<span class="ident">nullable_ptr</span>.<span class="ident">is_null</span>(){
        <span class="macro">println</span><span class="macro">!</span>(<span class="string">&quot;Library has a null symbol&quot;</span>);
    }
    <span class="comment">//while Symbol is good for everything, RefMut requires one less dereference to use</span>
    <span class="kw-2">*</span><span class="kw-2">*</span><span class="ident">api</span>.<span class="ident">mut_ref_i32</span> <span class="op">=</span><span class="number">34</span>;
    <span class="kw-2">*</span><span class="ident">api</span>.<span class="ident">the_same_mut_ref_i32</span> <span class="op">=</span><span class="number">35</span>;
    <span class="kw">unsafe</span>{<span class="kw-2">*</span><span class="kw-2">*</span><span class="ident">api</span>.<span class="ident">not_nullable_ptr</span> <span class="op">=</span> <span class="number">55.0</span>};
    <span class="kw">unsafe</span>{<span class="kw-2">*</span><span class="kw-2">*</span><span class="ident">api</span>.<span class="ident">nullable_ptr</span> <span class="op">=</span> <span class="number">0</span>};
}</pre></div>
<p>Please notice several supported features:</p>
<ul>
<li>By default <code>SymBorApi</code> uses the field name to obtain a symbol from the library.
You can override the symbol name using the <code>dlopen_name</code> attribute.</li>
<li>All kind of objects from the <code>symbor</code> module implement the Deref or DerefMut trait.
This means that you can use them as if you would use primitive types that they wrap.</li>
<li>You can obtain optional symbols. This is very useful when you are dealing with
different versions of libraries and the new versions support more functions.
If it is not possible to obtain the given symbol, the option is set to `None',
otherwise it contains the obtained symbol.</li>
<li>Both <code>Symbol</code> and <code>Ref</code> or <code>RefMut</code> can be used to obtain references to statically
allocated objects. But <code>Ref</code> and <code>RefMut</code> are just easier to use - they require
less dereferences to access the final value.
Actually they behave like a normal reference does, it just that they implement the
<code>FromRawResult</code> interface that allows them to be used inside structures that implement
the <code>SymBorApi</code> trait.</li>
</ul>
</div><h2 id="required-methods" class="small-section-header">Required methods<a href="#required-methods" class="anchor"></a></h2><div class="methods"><h3 id="tymethod.load" class="method"><code>unsafe fn <a href="#tymethod.load" class="fnname">load</a>(lib: &amp;'a <a class="struct" href="../../dlopen/symbor/struct.Library.html" title="struct dlopen::symbor::Library">Library</a>) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;Self, <a class="enum" href="../../dlopen/enum.Error.html" title="enum dlopen::Error">Error</a>&gt;</code></h3></div><span class="loading-content">Loading content...</span><h2 id="implementors" class="small-section-header">Implementors<a href="#implementors" class="anchor"></a></h2><div class="item-list" id="implementors-list"></div><span class="loading-content">Loading content...</span><script type="text/javascript" src="../../implementors/dlopen/symbor/trait.SymBorApi.js" async></script></section><section id="search" class="content hidden"></section><section class="footer"></section><script>window.rootPath = "../../";window.currentCrate = "dlopen";</script><script src="../../main.js"></script><script defer src="../../search-index.js"></script></body></html>